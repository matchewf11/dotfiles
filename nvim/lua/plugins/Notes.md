# This is from mini stuff -------------------------------------------------

-- ------------------------------------------------------------------------------
--                                                    *mini.nvim-disabling-recipes*
-- Each module's core functionality can be disabled globally or buffer-locally
-- by creating appropriate global or buffer-scoped variables equal to |v:true|.
-- Functionality is disabled if at least one of |g:| or |b:| variables is `v:true`.
--
-- Variable names have the same structure: `{g,b}:mini*_disable` where `*` is
-- module's lowercase name. For example, `g:minianimate_disable` disables
-- |mini.animate| globally and `b:minianimate_disable` - for current buffer.
-- Note: in this section disabling 'mini.animate' is used as example;
-- everything holds for other module variables.
--
-- Considering high number of different scenarios and customization intentions,
-- writing exact rules for disabling module's functionality is left to user.
--
-- # Manual disabling ~
-- >lua
--   -- Disable globally
--   vim.g.minianimate_disable = true
--
--   -- Disable for current buffer
--   vim.b.minianimate_disable = true
--
--   -- Toggle (disable if enabled, enable if disabled)
--   vim.g.minianimate_disable = not vim.g.minianimate_disable -- globally
--   vim.b.minianimate_disable = not vim.b.minianimate_disable -- for buffer
-- <
-- # Automated disabling ~
--
-- Automated disabling is suggested to be done inside autocommands: >lua
--
--   -- Disable for a certain filetype (for example, "lua")
--   local f = function(args) vim.b[args.buf].minianimate_disable = true end
--   vim.api.nvim_create_autocmd('Filetype', { pattern = 'lua', callback = f })
--
--   -- Enable only for certain filetypes (for example, "lua" and "help")
--   local f = function(args)
--     local ft = vim.bo[args.buf].filetype
--     if ft == 'lua' or ft == 'help' then return end
--     vim.b[args.buf].minianimate_disable = true
--   end
--   vim.api.nvim_create_autocmd('Filetype', { callback = f })
--
--   -- Disable in Visual mode
--   local f_en = function(args) vim.b[args.buf].minianimate_disable = false end
--   local enable_opts = { pattern = '[vV\x16]*:*', callback = f_en }
--   vim.api.nvim_create_autocmd('ModeChanged', enable_opts)
--
--   local f_dis = function(args) vim.b[args.buf].minianimate_disable = true end
--   local disable_opts = { pattern = '*:[vV\x16]*', callback = f_dis }
--   vim.api.nvim_create_autocmd('ModeChanged', disable_opts)
--
--   -- Disable in Terminal buffer
--   local f = function(args) vim.b[args.buf].minianimate_disable = true end
--   vim.api.nvim_create_autocmd('TermOpen', { callback = f })
-- <
-- ------------------------------------------------------------------------------
--                                                  *mini.nvim-buffer-local-config*
-- Each module can be additionally configured locally to buffer by creating
-- appropriate buffer-scoped variable with values to override. It affects only
-- runtime options and not those used once during setup (like most `mappings`).
--
-- Variable names have the same structure: `b:mini*_config` where `*` is
-- module's lowercase name. For example, `b:minianimate_config` can store
-- information about how |mini.animate| will act inside current buffer. Its
-- value should be a table with same structure as module's `config`. Example: >lua
--
--   -- Disable scroll animation in current buffer
--   vim.b.minianimate_config = { scroll = { enable = false } }
-- <
-- Considering high number of different scenarios and customization intentions,
-- writing exact rules for module's buffer local configuration is left to
-- user. It is done in similar fashion to |mini.nvim-disabling-recipes|.
--
-- ------------------------------------------------------------------------------
--                                                        *mini.nvim-color-schemes*
-- - Color schemes based on |mini.hues|: |MiniHues-color-schemes|.
-- - Color schemes based on |mini.base16|: |MiniBase16-color-schemes|.

-- look at all
-- https://github.com/nvim-mini/mini.nvim/blob/main/doc/mini-nvim.txt
-- also the general ones
-- read more about mini ecosystem
-- read about plugins that i have
--
-- for mini.pick
-- start with ripgrep
-- start with fd
-- start with git

-- return {
-- 'stevearc/oil.nvim',
-- opts = {
--   delete_to_trash = true,
--   watch_for_changes = true,
--   view_options = {
--     show_hidden = true,
--     is_always_hidden = function(name, _)
--       return name == '..'
--     end,
--   },
-- },
-- dependencies = { 'nvim-mini/mini.nvim' },
-- }

-- return {
--   'folke/which-key.nvim',
--   event = 'VeryLazy',
--   opts = {
--     delay = 0,
--     spec = {
--       { '<leader>s', group = '[s]earch' },
--       { '<leader>g', group = '[g]it' },
--     },
--   },
-- }

-- get rid of status in left (use vim default)
-- get rid of mode on bottom line?

-- vim.o.laststatus = 3
--
-- function _G.statusline()
--   ---@generic T, R
--   ---@param tbl T[]
--   ---@param fn fun(acc: R, v: T): R
--   ---@param init R
--   ---@return R
--   local function tbl_reduce(tbl, fn, init)
--     local acc = init
--     for _, v in ipairs(tbl) do
--       acc = fn(acc, v)
--     end
--     return acc
--   end
--
--   local severity = vim.diagnostic.severity
--
--   local counts = tbl_reduce(vim.diagnostic.get(0), function(acc, d)
--     acc[d.severity] = acc[d.severity] + 1
--     return acc
--   end, { 0, 0, 0, 0 })
--
--   return ' '
--     .. table.concat(
--       vim.tbl_filter(function(s)
--         return s ~= ''
--       end, {
--         -- file name
--         '%f',
--         -- git updates
--         (function()
--           if vim.b.gitsigns_head and vim.b.gitsigns_head ~= '' then
--             local git_section = vim.b.gitsigns_head
--             if vim.b.gitsigns_status and vim.b.gitsigns_status ~= '' then
--               git_section = git_section .. ' ' .. vim.b.gitsigns_status
--             end
--             return git_section
--           elseif vim.b.gitsigns_status and vim.b.gitsigns_status ~= '' then
--             return vim.b.gitsigns_status
--           end
--         end)(),
--         -- middle
--         '%=',
--         -- Warnings
--         table.concat(
--           vim.tbl_filter(
--             function(v)
--               return v
--             end,
--             vim.tbl_map(function(sev_tbl)
--               if counts[sev_tbl[1]] > 0 then
--                 return sev_tbl[2] .. ':' .. counts[sev_tbl[1]]
--               end
--             end, {
--               { severity.ERROR, 'E' },
--               { severity.WARN, 'W' },
--               { severity.INFO, 'I' },
--               { severity.HINT, 'H' },
--             })
--           ),
--           ' '
--         ),
--         -- file type
--         '[%M%R%H%W%Y]%q',
--         -- line numbers
--         '%l/%L:%c',
--       }),
--       ' | '
--     )
--     .. ' '
-- end
--
-- vim.o.statusline = '%!v:lua.statusline()'
--
--
--
--
--
-- return {
--   'saecki/crates.nvim',
--   event = { 'BufRead Cargo.toml' },
--   tag = 'stable',
--   config = function()
--     require('crates').setup {
--       lsp = {
--         enabled = true,
--         actions = true,
--         completion = true,
--         hover = true,
--       },
--       -- i use blink, can i use it with this
--       -- completion = {
--       --   cmp = { enabled = true },
--       -- },
--     }
--   end,
-- }

-- vim.api.nvim_create_autocmd("BufRead", {
--     group = vim.api.nvim_create_augroup("CmpSourceCargo", { clear = true }),
--     pattern = "Cargo.toml",
--     callback = function()
--         cmp.setup.buffer({ sources = { { name = "crates" } } })
--     end,
-- })

-- require("crates").setup {
--     ...
--     completion = {
--         ...
--         cmp = {
--             use_custom_kind = true,
--             -- optionally change the text and highlight groups
--             kind_text = {
--                 version = "Version",
--                 feature = "Feature",
--             },
--             kind_highlight = {
--                 version = "CmpItemKindVersion",
--                 feature = "CmpItemKindFeature",
--             },
--         },
--     },
-- }

-- local kind_icons = {
--     ["Class"] = "🅒 ",
--     ["Interface"] = "🅘 ",
--     ["TypeParameter"] = "🅣 ",
--     ["Struct"] = "🅢 ",
--     ["Enum"] = "🅔 ",
--     ["Unit"] = "🅤 ",
--     ["EnumMember"] = "🅔 ",
--     ["Constant"] = "🅒 ",
--     ["Field"] = "🅕 ",
--     ["Property"] = "🅟 ",
--     ["Variable"] = "🅥 ",
--     ["Reference"] = "🅡 ",
--     ["Function"] = "🅕 ",
--     ["Method"] = "🅜 ",
--     ["Constructor"] = "🅒 ",
--     ["Module"] = "🅜 ",
--     ["File"] = "🅕 ",
--     ["Folder"] = "🅕 ",
--     ["Keyword"] = "🅚 ",
--     ["Operator"] = "🅞 ",
--     ["Snippet"] = "🅢 ",
--     ["Value"] = "🅥 ",
--     ["Color"] = "🅒 ",
--     ["Event"] = "🅔 ",
--     ["Text"] = "🅣 ",
--
--     -- crates.nvim extensions
--     ["Version"] = "🅥 ",
--     ["Feature"] = "🅕 ",
-- }
--
-- require("cmp").setup({
--     formatting = {
--         fields = { "abbr", "kind" },
--         format = function(_, vim_item)
--             vim_item.kind = kind_icons[vim_item.kind] or "  "
--             return vim_item
--         end,
--     },
-- })

-- require("crates").setup {
--     ...
--     completion = {
--         ...
--         coq = {
--             enabled = true,
--             name = "crates.nvim",
--         },
--     },
-- }

-- require("crates").setup {
--     ...
--     completion = {
--         crates = {
--             enabled = true -- disabled by default
--             max_results = 8 -- The maximum number of search results to display
--             min_chars = 3 -- The minimum number of charaters to type before completions begin appearing
--         }
--     }
-- }

-- require("crates").setup {
--     ...
--     null_ls = {
--         enabled = true,
--         name = "crates.nvim",
--     },
-- }

-- require("crates").setup {
--     smart_insert = true,
--     remove_enabled_default_features = true,
--     remove_empty_features = true,
--     insert_closing_quote = true,
--     autoload = true,
--     autoupdate = true,
--     autoupdate_throttle = 250,
--     loading_indicator = true,
--     search_indicator = true,
--     date_format = "%Y-%m-%d",
--     thousands_separator = ".",
--     notification_title = "crates.nvim",
--     curl_args = { "-sL", "--retry", "1" },
--     max_parallel_requests = 80,
--     expand_crate_moves_cursor = true,
--     enable_update_available_warning = true,
--     on_attach = function(bufnr) end,
--     text = {
--         searching = "   Searching",
--         loading = "   Loading",
--         version = "   %s",
--         prerelease = "   %s",
--         yanked = "   %s",
--         nomatch = "   No match",
--         upgrade = "   %s",
--         error = "   Error fetching crate",
--     },
--     highlight = {
--         searching = "CratesNvimSearching",
--         loading = "CratesNvimLoading",
--         version = "CratesNvimVersion",
--         prerelease = "CratesNvimPreRelease",
--         yanked = "CratesNvimYanked",
--         nomatch = "CratesNvimNoMatch",
--         upgrade = "CratesNvimUpgrade",
--         error = "CratesNvimError",
--     },
--     popup = {
--         autofocus = false,
--         hide_on_select = false,
--         copy_register = '"',
--         style = "minimal",
--         border = "none",
--         show_version_date = false,
--         show_dependency_version = true,
--         max_height = 30,
--         min_width = 20,
--         padding = 1,
--         text = {
--             title = " %s",
--             pill_left = "",
--             pill_right = "",
--             description = "%s",
--             created_label = " created        ",
--             created = "%s",
--             updated_label = " updated        ",
--             updated = "%s",
--             downloads_label = " downloads      ",
--             downloads = "%s",
--             homepage_label = " homepage       ",
--             homepage = "%s",
--             repository_label = " repository     ",
--             repository = "%s",
--             documentation_label = " documentation  ",
--             documentation = "%s",
--             crates_io_label = " crates.io      ",
--             crates_io = "%s",
--             lib_rs_label = " lib.rs         ",
--             lib_rs = "%s",
--             categories_label = " categories     ",
--             keywords_label = " keywords       ",
--             version = "  %s",
--             prerelease = " %s",
--             yanked = " %s",
--             version_date = "  %s",
--             feature = "  %s",
--             enabled = " %s",
--             transitive = " %s",
--             normal_dependencies_title = " Dependencies",
--             build_dependencies_title = " Build dependencies",
--             dev_dependencies_title = " Dev dependencies",
--             dependency = "  %s",
--             optional = " %s",
--             dependency_version = "  %s",
--             loading = "  ",
--         },
--         highlight = {
--             title = "CratesNvimPopupTitle",
--             pill_text = "CratesNvimPopupPillText",
--             pill_border = "CratesNvimPopupPillBorder",
--             description = "CratesNvimPopupDescription",
--             created_label = "CratesNvimPopupLabel",
--             created = "CratesNvimPopupValue",
--             updated_label = "CratesNvimPopupLabel",
--             updated = "CratesNvimPopupValue",
--             downloads_label = "CratesNvimPopupLabel",
--             downloads = "CratesNvimPopupValue",
--             homepage_label = "CratesNvimPopupLabel",
--             homepage = "CratesNvimPopupUrl",
--             repository_label = "CratesNvimPopupLabel",
--             repository = "CratesNvimPopupUrl",
--             documentation_label = "CratesNvimPopupLabel",
--             documentation = "CratesNvimPopupUrl",
--             crates_io_label = "CratesNvimPopupLabel",
--             crates_io = "CratesNvimPopupUrl",
--             lib_rs_label = "CratesNvimPopupLabel",
--             lib_rs = "CratesNvimPopupUrl",
--             categories_label = "CratesNvimPopupLabel",
--             keywords_label = "CratesNvimPopupLabel",
--             version = "CratesNvimPopupVersion",
--             prerelease = "CratesNvimPopupPreRelease",
--             yanked = "CratesNvimPopupYanked",
--             version_date = "CratesNvimPopupVersionDate",
--             feature = "CratesNvimPopupFeature",
--             enabled = "CratesNvimPopupEnabled",
--             transitive = "CratesNvimPopupTransitive",
--             normal_dependencies_title = "CratesNvimPopupNormalDependenciesTitle",
--             build_dependencies_title = "CratesNvimPopupBuildDependenciesTitle",
--             dev_dependencies_title = "CratesNvimPopupDevDependenciesTitle",
--             dependency = "CratesNvimPopupDependency",
--             optional = "CratesNvimPopupOptional",
--             dependency_version = "CratesNvimPopupDependencyVersion",
--             loading = "CratesNvimPopupLoading",
--         },
--         keys = {
--             hide = { "q", "<esc>" },
--             open_url = { "<cr>" },
--             select = { "<cr>" },
--             select_alt = { "s" },
--             toggle_feature = { "<cr>" },
--             copy_value = { "yy" },
--             goto_item = { "gd", "K", "<C-LeftMouse>" },
--             jump_forward = { "<c-i>" },
--             jump_back = { "<c-o>", "<C-RightMouse>" },
--         },
--     },
--     completion = {
--         insert_closing_quote = true,
--         text = {
--             prerelease = "  pre-release ",
--             yanked = "  yanked ",
--         },
--         cmp = {
--             enabled = false,
--             use_custom_kind = true,
--             kind_text = {
--                 version = "Version",
--                 feature = "Feature",
--             },
--             kind_highlight = {
--                 version = "CmpItemKindVersion",
--                 feature = "CmpItemKindFeature",
--             },
--         },
--         coq = {
--             enabled = false,
--             name = "crates.nvim",
--         },
--         blink = {
--             use_custom_kind = true,
--             kind_text = {
--                 version = "Version",
--                 feature = "Feature",
--             },
--             kind_highlight = {
--                 version = "BlinkCmpKindVersion",
--                 feature = "BlinkCmpKindFeature",
--             },
--             kind_icon = {
--                 version = " ",
--                 feature = " ",
--             },
--         },
--         crates = {
--             enabled = true,
--             min_chars = 3,
--             max_results = 8,
--         },
--     },
--     null_ls = {
--         enabled = false,
--         name = "crates.nvim",
--     },
--     neoconf = {
--         enabled = false,
--         namespace = "crates",
--     },
--     lsp = {
--         enabled = false,
--         name = "crates.nvim",
--         on_attach = function(client, bufnr) end,
--         actions = false,
--         completion = false,
--         hover = false,
--     },
-- }

-- require("crates").setup {
--     text = {
--         loading = "  Loading...",
--         version = "  %s",
--         prerelease = "  %s",
--         yanked = "  %s yanked",
--         nomatch = "  Not found",
--         upgrade = "  %s",
--         error = "  Error fetching crate",
--     },
--     popup = {
--         text = {
--             title = "# %s",
--             pill_left = "",
--             pill_right = "",
--             created_label = "created        ",
--             updated_label = "updated        ",
--             downloads_label = "downloads      ",
--             homepage_label = "homepage       ",
--             repository_label = "repository     ",
--             documentation_label = "documentation  ",
--             crates_io_label = "crates.io      ",
--             lib_rs_label = "lib.rs         ",
--             categories_label = "categories     ",
--             keywords_label = "keywords       ",
--             version = "%s",
--             prerelease = "%s pre-release",
--             yanked = "%s yanked",
--             enabled = "* s",
--             transitive = "~ s",
--             normal_dependencies_title = "  Dependencies",
--             build_dependencies_title = "  Build dependencies",
--             dev_dependencies_title = "  Dev dependencies",
--             optional = "? %s",
--             loading = " ...",
--         },
--     },
--     completion = {
--         text = {
--             prerelease = " pre-release ",
--             yanked = " yanked ",
--         },
--     },
-- }

-- -- Setup config and auto commands.
-- require("crates").setup(cfg: crates.UserConfig)
--
-- -- Disable UI elements (virtual text and diagnostics).
-- require("crates").hide()
-- -- Enable UI elements (virtual text and diagnostics).
-- require("crates").show()
-- -- Enable or disable UI elements (virtual text and diagnostics).
-- require("crates").toggle()
-- -- Update data. Optionally specify which `buf` to update.
-- require("crates").update(buf: integer?)
-- -- Reload data (clears cache). Optionally specify which `buf` to reload.
-- require("crates").reload(buf: integer?)
--
-- -- Upgrade the crate on the current line.
-- -- If the `alt` flag is passed as true, the opposite of the `smart_insert` config
-- -- option will be used to insert the version.
-- require("crates").upgrade_crate(alt: boolean?)
-- -- Upgrade the crates on the lines visually selected.
-- -- See `crates.upgrade_crate()`.
-- require("crates").upgrade_crates(alt: boolean?)
-- -- Upgrade all crates in the buffer.
-- -- See `crates.upgrade_crate()`.
-- require("crates").upgrade_all_crates(alt: boolean?)
--
-- -- Update the crate on the current line.
-- -- See `crates.upgrade_crate()`.
-- require("crates").update_crate(alt: boolean?)
-- -- Update the crates on the lines visually selected.
-- -- See `crates.upgrade_crate()`.
-- require("crates").update_crates(alt: boolean?)
-- -- Update all crates in the buffer.
-- -- See `crates.upgrade_crate()`.
-- require("crates").update_all_crates(alt: boolean?)
--
-- -- Expand a plain crate declaration into an inline table.
-- require("crates").expand_plain_crate_to_inline_table()
-- -- Extract an crate declaration from a dependency section into a table.
-- require("crates").extract_crate_into_table()
-- -- Convert crate dependency to use a git source instead of version number.
-- require("crates").use_git_source()
--
-- -- Open the homepage of the crate on the current line.
-- require("crates").open_homepage()
-- -- Open the repository page of the crate on the current line.
-- require("crates").open_repository()
-- -- Open the documentation page of the crate on the current line.
-- require("crates").open_documentation()
-- -- Open the `crates.io` page of the crate on the current line.
-- require("crates").open_crates_io()
-- -- Open the `lib.rs` page of the crate on the current line.
-- require("crates").open_lib_rs()
--
-- -- Returns whether there is information to show in a popup.
-- require("crates").popup_available(): boolean
-- -- Show/hide popup with crate details, all versions, all features or details about one feature.
-- -- If `popup.autofocus` is disabled calling this again will focus the popup.
-- require("crates").show_popup()
-- -- Same as `crates.show_popup()` but always show crate details.
-- require("crates").show_crate_popup()
-- -- Same as `crates.show_popup()` but always show versions.
-- require("crates").show_versions_popup()
-- -- Same as `crates.show_popup()` but always show features or features details.
-- require("crates").show_features_popup()
-- -- Same as `crates.show_popup()` but always show dependencies.
-- require("crates").show_dependencies_popup()
-- -- Focus the popup (jump into the floating window).
-- -- Optionally specify the line to jump to, inside the popup.
-- require("crates").focus_popup(line: integer?)
-- -- Hide the popup.
-- require("crates").hide_popup()

--  :Crates <subcmd>-
-- hide()
-- show()
-- toggle()
-- update()
-- reload()
-- upgrade_crate()
-- upgrade_crates()
-- upgrade_all_crates()
-- update_crate()
-- update_crates()
-- update_all_crates()
-- use_git_source()
-- expand_plain_crate_to_inline_table()
-- extract_crate_into_table()
-- open_homepage()
-- open_repository()
-- open_documentation()
-- open_cratesio()
-- popup_available()
-- show_popup()
-- show_crate_popup()
-- show_versions_popup()
-- show_features_popup()
-- show_dependencies_popup()
-- focus_popup()
-- hide_popup()

-- local crates = require("crates")
-- local opts = { silent = true }
--
-- vim.keymap.set("n", "<leader>ct", crates.toggle, opts)
-- vim.keymap.set("n", "<leader>cr", crates.reload, opts)
--
-- vim.keymap.set("n", "<leader>cv", crates.show_versions_popup, opts)
-- vim.keymap.set("n", "<leader>cf", crates.show_features_popup, opts)
-- vim.keymap.set("n", "<leader>cd", crates.show_dependencies_popup, opts)
--
-- vim.keymap.set("n", "<leader>cu", crates.update_crate, opts)
-- vim.keymap.set("v", "<leader>cu", crates.update_crates, opts)
-- vim.keymap.set("n", "<leader>ca", crates.update_all_crates, opts)
-- vim.keymap.set("n", "<leader>cU", crates.upgrade_crate, opts)
-- vim.keymap.set("v", "<leader>cU", crates.upgrade_crates, opts)
-- vim.keymap.set("n", "<leader>cA", crates.upgrade_all_crates, opts)
--
-- vim.keymap.set("n", "<leader>cx", crates.expand_plain_crate_to_inline_table, opts)
-- vim.keymap.set("n", "<leader>cX", crates.extract_crate_into_table, opts)
--
-- vim.keymap.set("n", "<leader>cH", crates.open_homepage, opts)
-- vim.keymap.set("n", "<leader>cR", crates.open_repository, opts)
-- vim.keymap.set("n", "<leader>cD", crates.open_documentation, opts)
-- vim.keymap.set("n", "<leader>cC", crates.open_crates_io, opts)
-- vim.keymap.set("n", "<leader>cL", crates.open_lib_rs, opts)

-- local function show_documentation()
--     local filetype = vim.bo.filetype
--     if filetype == "vim" or filetype == "help" then
--         vim.cmd('h '..vim.fn.expand('<cword>'))
--     elseif filetype == "man" then
--         vim.cmd('Man '..vim.fn.expand('<cword>'))
--     elseif vim.fn.expand('%:t') == 'Cargo.toml' and require('crates').popup_available() then
--         require('crates').show_popup()
--     else
--         vim.lsp.buf.hover()
--     end
-- end
--
-- vim.keymap.set('n', 'K', show_documentation, { silent = true })

-- require("crates").setup {
--     ...
--     neoconf = {
--         enabled = false,
--         namespace = "crates",
--
--     },
-- }

--// .neoconf.json
-- {
--     //...
--     "crates": {
--         "smart_insert": false,
--         "max_parallel_requests": 50,
--         "completion": {
--             "crates": {
--                 "enabled": false
--             }
--         }
--     }
-- }

-- do this in teh other file
-- require("cmp").setup {
--     ...
--     sources = {
--         { name = "path" },
--         { name = "buffer" },
--         { name = "nvim_lsp" },
--         ...
--         { name = "crates" },
--     },
-- }
--

-- make kepmap to move to next or prev diagnostic? '[d', '[D', ']d', ']D'
-- fugative or mini.git


key map terminal emulator and open minifiles/oil
put merge conflicts in quickfix?
